# Predefined stack templates

## Stack template structure
```
<no>_<template-name>
├─volumes
│ ├─volume1
│ ├─volume2
│ ├─volume3
│ └─...
├─config.json
├─docker-compose.yml
└─environment.env
```

## Configuration file ([example file](1_lamp/config.json))
A template must contain a file called `config.json`, which holds metadata about the template.<br>
It consists of following parts:

- `label` - Specifies the display name of the template. This name is used in the list for template selection
- `dir` - Name of the directory, the template is located in e.g.: `1_lamp`
- `questions` - Lists of quesions, which the cli will ask the user.
	- `text` - Question itself (keep it as short as possible).
	- `type` - 1 = Yes/No question, 2 = Text question
	- `defaultValue` - Default value of the question (Will be displayed in braces after the question)
	- `validator` - Choose from `no-spaces`, `email`, `port`, `hostname` and `env-var-name` to validate the user input and print an error message if the validation fails
	- `var` - Name of the variable, which the answer of the question will be assigned to.
	- `advanced` - false = show question always, true = show question only in advanced mode
	- `withDockerfile` - false = show question always, true = show question only if the flag `--with-dockerfile` is set
- `volumes` - List of volumes which are used in the compose file
	- `text` - Question for customizing the volume
	- `defaultValue` - Default path on the host system. Relative to the generated compose file
	- `var` - Name of the variable, which the answer of the question will be assigned to (Must have the prefix `VOLUME_`).
	- `advanced` - false = show question always, true = show question only in advanced mode
	- `withDockerfile` - false = show question always, true = show question only if the flag `--with-dockerfile` is set
- `secrets` - List of secrets, that will be generated by the cli
	- `name` - Designation of the secret (should be precise and understandable to the user)
	- `var` - Name of the variable, which the generated password will be assigned to (Must start with an underscore).
	- `length` - Length of the secret in characters

## Compose file ([example file](1_lamp/docker-compose.yml))
A template also must contain the main compose file `docker-compose.yml`, which contains the container configuration for the stack.<br>
Within the configuration, you can make use of the defined variables in the configuration file with doubled curly braces and a leading dollar sign like so: `${{VARIABLE_NAME}}`.<br>
An example:

```
...
ports:
  - "${{HOST_APP_PORT}}:80"
...
```

There are two predefined variables, which the cli will provide:

- `${{PROJECT_NAME}}` = Name of the project, which is a mandatory question of the cli
- `${{PROJECT_NAME_CONTAINER}}` = Same as above, just in [kebab-case](https://medium.com/better-programming/string-case-styles-camel-pascal-snake-and-kebab-case-981407998841#a084).

*Note: This configuration will use an environment variable from the host system: `${VARIABLE_NAME}`. Don't confuse the notations*

## Environment file ([example file](1_lamp/environment.env))
This file consists of key-value pares, and is not mandatory and should only be used for secrets, usernames, configurable paths, urls, etc.
The `environment.env` file is the only one where the secret variables (the ones starting with an underscore) from the configuration file will be applied by the cli.<br>
The environment file can be attached to a container by including it into the compose file like this:
```
...
services:
  database:
	env_file:
	  - environment.env
...
```

## README file ([example file](1_lamp/README.md))
This file contains instructions about using the predefined template.